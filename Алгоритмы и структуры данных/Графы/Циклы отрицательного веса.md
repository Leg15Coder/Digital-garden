### Проблема

- Если в графе есть цикл отрицательного веса, то по нему можно ходить бесконечно, улучшая путь в меньшую сторону.

- Найти цикл отрицательного веса могут алгоритмы [[Алгоритм Форда-Беллмана|Форда-Беллмана]] и [[Алгоритм Флойда-Уоршелла|Флойда-Уоршелла]].

### Алгоритм Форда-Беллмана для поиска цикла

1) Адаптируем алгоритм Форда-Беллмана так, чтобы он хранил для каждой вершины ещё и предка, из которого она релаксировалась.
2) Если на $|V|$-й итерации произошла релаксация, то существует путь длинней $|V|$, то есть имеющий цикл, причём вес пути строго меньше подпути без цикла, следовательно, вес цикла отрицательный. 
3) Вершину из цикла можно найти по диагонали $dp$ ($dp[v][v][|V| < 0]$ $\Rightarrow$ вершина $v$ в отрицательном цикле). Восстановить цикл можно по информации из 1-го пункта.


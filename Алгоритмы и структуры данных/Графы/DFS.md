==Опр.== **Depth First Dearch (DFS, обход в глубину)** - обход [[Понятие графа|графа]], в ходе которого вершины посещаются как только обнаружены.

### Псевдокод

![[Pasted image 20250612094320.png]]

### Раскраска DFS

Цвет раскраски будет состоять из пары $(c,\ t)$, где $c$ - её фактический цвет, а $t$ - таймер вершины.

1) В dfs выделим три фактических цвета:

- *Белый цвет* — вершина еще не была посещена обходом. ^5c992c
- *Серый цвет* — вершина была посещена, но рекурсия еще не вышла из нее.
- *Чёрный цвет* — рекурсия вышла из вершины. ^d52706

(В неорграфе серый цвет не обязателен)

2) Таймер будет запоминать *время входа* в вершину и *время выхода* из неё

- Время входа $t_{in}$ ($t_{in}(v)$ - соответственно найти время входа вершины $v$) - такт, когда  вершина была покрашена в серый цвет.
- Время выхода $t_{out}$ ($t_{out}(v)$ - соответственно найти время выхода вершины $v$) - такт, когда  вершина была покрашена в чёрный цвет.

### Дерево обхода

==Опр.== **Древесное ребро** — ориентированное ребро, по которому DFS переходит напрямую (переходы в белые вершины из серых).

==Опр.== **Обратное ребро** — ориентированное ребро, которое DFS просматривает, но не идет по нему (переходы в серые вершины).

==Опр.== **Дерево обхода DFS** — граф, состоящий из вершин, посещаемых в ходе обхода DFS и древесных и обратных рёбер.

![[Pasted image 20250612122710.png]]
на рис. слева граф, а справа дерево обхода. Древесные рёбра показаны сплошной линией, а обратные - пунктирной.

### Асимптотика

(для сильно связного графа)
1) По времени: посетить все вершины и у каждой рассмотреть всех соседей (по рёбрам), поэтому $O(|V| + |E|)$
2) По памяти: максимальная память - глубина стека рекурсии. В стеке максимум все вершины, поэтому $O(|V|)$

- Строит максимальный поток через сеть. 

## Алгоритм

1) Пусть текущий поток $f = 0$.
2) Пока существует путь из истока в сток, кратчайший по количеству рёбер дополняющий поток $f'$ вдоль него
3) $f = f + f'$
4) Обновляем остаточную сеть

## Корректность

Улучшает [[Алгоритм Форда-Фалкерсона|алгоритм Форда-Фалкерсона]]. Полностью следует из него.
## Асимптотика

### Лемма о неубывании расстояний

- Если в сети $\mathcal{N}$ увеличение потока происходит только вдоль кратчайших путей (по количеству рёбер) из истока в сток остаточной сети $\mathcal{N}_f$, то $\forall v \in V/\{s, d\}\ :\ d_f(s, v)$ не убывает, где $d_f(s, v)$ - длина кратчайшего пути из $s$ в $v$ в остаточной сети.

#### Доказательство

Пусть $f$ и $f'$ - потоки в $\mathcal{N}$, между которыми одна итерация алгоритма ($f'$ более поздний поток). 

Предположим противно: $\exists v \in V\ :\ d_{f'}(s, v) < d_{f}(s, v)$. 
Рассмотрим путь $p$ от $s$ до $v$ и предпоследнюю вершину этого пути ($u$): $p = (s, ..., u, v)$, тогда $d_{f'}(s, v) = d_{f'}(s, u) + 1$ и исходя из предположения, получаем: $d_{f'}(s, u) \geq d_f(s, u)$.
Рассмотрим случаи:

1) Ребро $(u, v)$ уже было в остаточной сети.

Тогда $d_f(s, v) \leq d_f(s, u) + 1 \leq d_{f'}(s, u) + 1 = d_{f'}(s, v)$ - противоречие предположению.

2) Ребро $(u, v)$ уже появилось в остаточной сети на последней итерации.

Значит, в исходной сети было ребро $(v,u)$, по которому увеличили поток, тем самым создав обратное ребро $(u,v)$ в остаточной сети. Из этого следует (в силу увеличения потока только вдоль кратчайших путей), что увеличение потока происходило вдоль $p$, значит $d_f(s, u) = d_f(s, v) + 1$, тогда $d_f(s, v) \leq d_{f'}(s, u) - 1 = d_{f'}(s, v) - 2$ - противоречие предположению.

В любом случае получаем противоречие, поэтому лемма доказана.

### Асимптотика

1) **По времени**

Пусть $e \in p$ ($p$ - кратчайший путь из истока в сток) - **критическое**, если в $c_f(e) = \min\limits_{e\ \in\ p} c_f(e)$. 

Заметим, что после увеличения все критические рёбра исчезают из остаточной сети. Рассмотрим $(u, v) \in E$ Увеличение производится вдоль кратчайших путей, поэтому если $(u, v)$ становится критическим в первый раз, то $d_f(s, v) = d_f(s, u) + 1$. Затем оно исчезает из сети и не появится, пока не будет уменьшено по обратному ребру $(v, u)$. Пусть в момент перед увеличением поток в сети составлял $f'$, тогда $d_{f'}(s, u) = d_{f'}(s, v) + 1$ и согласно лемме о неубывании расстояний $d_f(s, v) \leq d_{f'}(s, v)$, откуда $d_{f'}(s, u) = d_{f'}(s, v) + 1 \geq d_f(s, u) + 2$. 

- Получаем, что между итерациями, когда $(u, v)$ становится критическим расстояние от $s$ до $u$ увеличивается на 2, откуда оно могло становиться критическим $O(|V|)$ раз.
- Всего рёбер $O(|E|)$, значит суммарное число итераций составит $O(|V||E|)$.
- Время работы каждой итерации $O(|V| + |E|) = O(|E|)$ в силу связности графа.

**Итоговая асимптотика по времени**: $O(|V||E|^2)$

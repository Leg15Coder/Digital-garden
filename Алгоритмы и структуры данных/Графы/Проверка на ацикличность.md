### Критерий найденного цикла

- В графе есть цикл, достижимый из вершины $s$, тогда и только тогда, когда DFS из вершины $s$ нашел ребро в серую вершину.

#### Доказательство.

**Необходимость**: Пусть $C$ - цикл, достижимый из $s$. Пусть $v$ - первая посещённая вершина цикла, а $u$ - предок $v$ в цикле ($(u,v) \in C$), тогда в момент захода в неё весь $C$ белый, а в момент выхода из неё весь цикл станет чёрным (по [[Лемма о белых путях|лемме о белых путях]]). В частности, чёрной будет и $u$, а значит $v$ была серой, когда мы посетили $u$.

**Достаточность**: Стек рекурсии — путь из серых вершин, так как в стек вершины кладутся последовательно (строится путь), чёрные там быть не могут (они удаляются из стека), а белые при попадании красятся в серый. При этом, если найдено ребро в серую, то это ребро куда-то в вершину выше по стеку рекурсии, вот и цикл.

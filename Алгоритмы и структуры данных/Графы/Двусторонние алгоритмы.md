# Двусторонний [[BFS]]

- ***Алгоритм корректен только если все рёбра весят одинаково***

- Требуется найти кратчайшее расстояние от $s$ до $t$

### Алгоритм

1) Запускаем BFS параллельно от $s$ и по транспонированному графу от $t$
2) Когда BFS по обычному графу добавит в ответы расстояние до вершины, которая находится в очереди или BFS по транспонированному графу, будет найдено кратчайшее расстояние между ними (Если общая вершина $u$, то $dist(s, t) = d[u] + d^T[u]$).

# Двусторонний [[Алгоритм Дейкстры|алгоритм Дейкстры]]

- Требуется найти кратчайшее расстояние от $s$ до $t$ в графе, где рёбра имеют неотрицательные веса.

### Алгоритм

1) Запускаем алгоритм Дейкстры параллельно от $s$ и по транспонированному графу от $t$
2) Пусть $m$ - вершина, до которой оба алгоритма добрались одновременно $S$ - рассчитанные расстояния обычной Дейкстрой, а $S^T$ - транспонированной, тогда:
$dist(s, t) = \min\{dist(s, m) + dist(m, t),\ \min\limits_{u\ \in\ S,\ v\ \in\ S^T} dist(s, v) + weight_{u \to v} + dist(v, t)\}$
# Двусторонняя [[A star|A*]]

- Требуется найти кратчайшее расстояние от $s$ до $t$ в графе, где рёбра имеют неотрицательные веса. Требуется эвристический подход.

- Нельзя просто так запустить двустороннюю $A^*$, так как в таком случае эвристики будут несогласованные. Требуется согласовать эвристику по обычному графу с эвристикой по транспонированному.

### Алгоритм

1) Доработаем эвристики. Пусть $h_s(v)$ - эвристика для $dist(s, v)$, а $h_е(v)$ - эвристика для $dist(t, v)$.
2) Условие согласованности: $h_s(u) + h_t(u) = h_s(v) + h_t(v) = const$. $h'_f(v) = \frac{h_f(v) - h_t(v)}{2} = -h'_t(v)$.
3) Модифицируем граф, чтобы эвристика влияла не на выбор вершины, а на переход по ребру: $weight^h_{u \to v} = weight_{u \to v} - h(u) + h(v)$. Такую модификацию применим к $G$ с $h = h'_s$ и к $G^T$ с $h = h'_t$
4) Пусть $m$ - вершина, до которой оба алгоритма добрались одновременно $S$ - рассчитанные расстояния обычной $A^*$, а $S^T$ - транспонированной, тогда:
$dist(s, t) = \min\{dist(s, m) + dist(m, t),\ \min\limits_{u\ \in\ S,\ v\ \in\ S^T} dist(s, v) + weight_{u \to v} + dist(v, t)\}$

# 0-1 BFS

- Пусть $G$ - взвешенный граф, в котором рёбра имеют вес только $0$ или $1$. Требуется найти кратчайшие расстояния от заданной стартовой вершины $s$ до всех остальных вершин графа.

## Алгоритм

1) Воспользуемся [[BFS|обходом в ширину]], но вместо очереди будет дек
2) Если вес рассматриваемой вершины 0, то добавим её в начало дека, иначе - в конец.

- Данный алгоритм строит уровни эквивалентности при нулевых переходах (если $v$ и $u$ связаны путём нулевого веса, то они в одном классе эквивалентности)

## Корректность

**Инвариант:** В деке всегда хранятся вершины, упорядоченные по неубыванию расстояний от старта.

**Доказательство:**
1. На каждом шаге мы извлекаем вершину с минимальным текущим расстоянием (из начала дека)
2. При переходе по рёбрам:
   - Нулевые рёбра не увеличивают расстояние - вершины добавляются в начало, сохраняя порядок
   - Рёбра веса 1 увеличивают расстояние на 1 - вершины добавляются в конец, что соответствует их большему расстоянию

**Следствие:** Первое посещение вершины гарантированно даёт кратчайшее расстояние.

## Асимптотика

- **Временная сложность:** $O(|V| + |E|)$
  - Каждая вершина и ребро обрабатываются ровно один раз
  - Операции с деком (добавление/извлечение с обоих концов) работают за $O(1)$
  
- **Пространственная сложность:** $O(|V|)$ (дек может содержать до $|V|$ вершин)

# 1-k BFS

- Пусть $G$ - взвешенный граф, где веса рёбер принимают целочисленные значения от $1$ до $k$. Требуется найти кратчайшие расстояния от заданной стартовой вершины $s$ до всех остальных вершин графа.

## Алгоритм

1. Используем модификацию [[BFS]] с $k+1$ очередями 
2. При обработке рёбер складываем текущее расстояние с весом ребра (получается суммарный вес $x$) и добавляем новую вершину в ($x \mod\ (k+1)$)-ю очередь.
3. На каждом шаге обрабатываем вершины из текущей очереди (по модулю $(k+1)$)

## Корректность

**Инвариант:** Вершины в очередях упорядочены по неубыванию расстояний.

**Доказательство:**
1. Очередь $i$ содержит вершины с расстоянием $d \equiv i \mod (k+1)$
2. Так как максимальный вес ребра $k$, разница между соседними расстояниями не превышает $k$
3. Обработка очередей по модулю гарантирует, что вершина будет обработана при минимально возможном расстоянии

**Следствие:** Каждая вершина обрабатывается ровно один раз с минимальным расстоянием.

## Асимптотика
- **Временная сложность:** $O(k|V| + |E|)$
  - Каждая вершина может быть обработана до $k$ раз (по разным очередям)
  - Каждое ребро обрабатывается один раз
  - Операции с очередями работают за $O(1)$

- **Пространственная сложность:** $O(k|V|)$
  - Хранение $k+1$ очередей
  - Массив расстояний

# 0-k BFS

- Пусть $G$ - взвешенный граф, где веса рёбер принимают целочисленные значения от $0$ до $k$. Требуется найти кратчайшие расстояния от заданной стартовой вершины $s$ до всех остальных вершин графа.

## Алгоритм

- Объединим идеи решений 0-1 bfs и 1-k bfs:
	Создадим $(k+1)$ дек, чтобы при встрече нуля добавлять его в начало соответствующей очереди

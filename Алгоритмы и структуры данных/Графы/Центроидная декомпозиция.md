==Опр.== **Центроид** *(в дереве)* - вершина, после удаления которой дерево разбивается на деревья, размер каждого из которых не больше размера исходного дерева делённого на два.

==Опр.== **Диаметр в дереве** - самый длинный (в рёбрах) простой путь в нём.

### Теорема о центроидах

- В любом дереве есть центроид и их не более 2-х, причём если ровно два, то они смежны.

#### Доказательство.

 **1. Существование хотя бы одного центроида**

Докажем, что в любом дереве есть хотя бы один центроид.

- **Алгоритм поиска центроида:**
    1. Выберем произвольную вершину $v$.
    2. Если $v$ — центроид (все её поддеревья $\leq \frac{N}{2}$​), завершаем.
    3. Иначе найдём смежную вершину $u$, ведущую в поддерево размера $\geq \frac{N}{2}$, и перейдём в $u$.
    4. Повторяем, пока не найдём центроид.
        
- **Почему алгоритм работает?**
    
    - На каждом шаге мы двигаемся в сторону единственного поддерева размера $> \frac{N}{2}$​ (так как сумма размеров всех поддеревьев $= N−1$, и только одно может быть больше $\frac{N}{2}$​).
        
    - Процесс конечен, так как дерево ациклично, и мы не можем вернуться в уже посещённую вершину.

**2. Не более двух центроидов**

Теперь докажем, что центроидов не может быть больше двух.

- **Предположим, есть два центроида $c_1$​ и $c_2$​:**
    - Удалим ребро между ними (если они смежны).
    - Дерево распадётся на две (возможно не связные) компоненты $T_1$​ и $T_2$​.
    - Так как $c_1$​ — центроид, размер $T_2 \leq \frac{N}{2}$​.
    - Так как $c_2$​ — центроид, размер $T_1 \leq \frac{N}{2}​$.
    - Но $|T_1| + |T_2| = N - 2$ (так как мы удалили $c_1$​ и $c_2$​).
    - Отсюда $N - 2 \leq \frac{N}{2} + \frac{N}{2}$, что верно, но равенство возможно только если $|T_1| = |T_2| = \frac{N}{2}$​.
    
- **Если центроидов три или больше:**
    
    - Для трёх центроидов c1,c2,c3c1​,c2​,c3​ аналогичные рассуждения приведут к противоречию, так как дерево не может быть разбито на три равные части размера n22n​.

### Алгоритм поиска диаметра

1) DFS-ом ищем самую дальнюю от корня вершину.
2) DFS-ом ищем самую дальнюю вершину от вершины из 1-го пункта.
3) Диаметр найден.

# Центроидная декомпозиция

==Опр.== **Центроидная декомпозиция ($CD$)** - $CD(T)$ - это дерево такое, что:
- Корнем $CD(T)$ является произвольный центроид $c$ дерева $T$
- Детьми $c$ в $CD(T)$ будут деревья $CD(T_1),\ ...,\ CD(T_k)$, где $T_i$ - одно из деревьев, которое получится после удаления $c$ в $T$

- ***Структура данных, решающая задачу [[Задачи RMQ и RSQ|static RMQ]].***

## Структура

Разреженная таблица (Sparce Table), как ни странно, имеет табличный вид (является двумерным массивом). Свойство разреженности подразумевает, что она инициализирована не полностью (строчки таблицы имеют разную длину).

![[Pasted image 20250727191414.png]]

Разреженная таблица строится над массивом длины $n$ для решения задачи static RMQ на этом массиве. При этом таблица имеет ширину $n$ и высоту $\lceil \log n \rceil$.

## Инициализация

Элемент $st_{ij}$ ищет минимум на подотрезке из $2^i$ элементов, который начинается с $j$-й позиции отрезка (нумерация с нуля). То есть первая строка - сам массив, вторая строка - минимум на всех подотрезках длины 2 и так далее. Если подотрезок имеет меньше $j$ элементов, то $st_{ij}$ не определен или не существует.

Построение таблицы происходит за счёт [[Динамическое программирование|ДП]]:

**База**: $st_{0j} = a_j$, где $a$ - исходный массив
**Порядок пересчёта**: внутренний цикл по позиции в строке ($j$), внешний - по строкам.
**Формула пересчёта**: $st_{ij} = \min\{st_{i-1,\ j};\ st_{i-1,\ j + 2^{i-1}}\}$

## Ответ на запрос

Пусть запрос найти минимум с позиции $l$ до позиции $r$ (включительно, нумерация с нуля), тогда ответ будет путём пересечения двух отрезков длины $2^k$, где $k$ максимальное целое число такое, что $2^k \leq r - l + 1$. ($k = \lfloor \log_2(r-l+1) \rfloor$)

**Ответ равен**: $\min\{st_{k,\ l},\ st_{k,\ r - 2^k + 1}\}$.

## Асимптотика

**По памяти**: $O(n \log n)$

**По времени**:
1) **Предподсчёт**: $O(n \log n)$
2) **Ответ на запрос**: $O(1)$

## Модификации

1) С помощью n-мерной разряженной таблицы можно решать $(n-1)$-мерную задачу.

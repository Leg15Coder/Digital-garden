==Опр.== Под понятием **"массив"** (*статический массив*) мы понимаем структуру данных, представляющую собой кусок памяти неизменного размера, состоящий из ячеек памяти, доступных для записи, чтения и изменения данных. Такой массив не имеет никаких методов и атрибутов, простой, быстрый, НО не безопасный и не гибкий.

==Опр.== **Динамический массив** - это такая структура данных, которая помимо записи, чтения и изменения данных в ячейках памяти поддерживает операции добавления и удаления **последнего** элемента. В отличие от обычного, статического, массива в динамическом массиве если элемент не был записан в ячейку, то данная ячейка считается пустой (несуществующей) для доступа.

- ***Далее под понятием массива будем понимать именно динамический массив, поскольку он более гибок, при этом асимптотически равен статическому.***

## Реализация
#### Создание

1) Изначально массив создаётся фиксированной ненулевой чётной длины. Но пустые ячейки недоступны для изменения и чтения.
2) У массива появляется два сопряжённых массива: один из них вдвое большего размера, а второй - вдвое меньшего.

#### Изменение ячейки массива

3) При изменении ячейки массива, она меняется (если доступна) и в сопряжённых массивах тоже.

#### Добавление нового элемента и аллокация

4) При добавлении нового элемента в массив, он записывается в самую левую пустую ячейку и она перестаёт быть пустой (становится доступной). При этом не более двух ячеек из основного массива записываются в больший массив (порядок записи последовательный слева на право по доступным ещё не записанным в больший массив ячейкам). И не более одной по аналогии в меньший массив.
5) Если последняя пустая ячейка становится доступной, то происходит *операция аллокации*: основным массивом становится массив большего размера, место меньшего массива занимает бывший основной (старый меньший удаляется), выделяется память под новый больший массив (вдвое большего размера, чем текущий основной).

#### Удаление элемента и деаллокация

6) При удалении элемента, он удаляется из сопряжённых массивов тоже.
7) Доля занятых ячеек памяти становится критически малой (например, менее 25%), то происходит *операция деаллокации*: меньший массив становится основным, бывший основной - большим, бывший больший - удаляется, выделятся память по новый меньший массив (вдвое меньшего размера, чем текущий основной). При этом деаллокация может происходить только в том случае, если меньший массив будет натурального размера.

## Асимптотика

Все операции работают за $O(1)$, а занимается памяти $O(n)$.

### Амортизированная реализация

Можно реализовать динамический массив, не используя сопряжённые массивы: когда наступает момент аллокации или деаллокации выделять вдвое большую/меньшую память и копировать туда все элементы по одному. Такая операция занимает $O(n)$ времени, но при этом происходит нечасто. Можно доказать [[Амортизационный анализ#Метод монеток|методом монеток]], что для такого массива все операции работают за $O(1^*)$:
1) На каждый элемент выдаём три монеты
2) При изменении элемента не взимается плата
3) При добавлении элемента тратится одна монета
4) При удалении элемента тратится одна монета
5) При копировании монеты в новую область тратится одна монета
6) Таким образом, при копировании новые элементы платят за себя и за элементы без монет. Аналогично с удалением.

==Опр.== **Биномиальное дерево** - ранговое дерево с рекурсивным определением:
1) Любое дерево из одной вершины является биномиальным деревом нулевого ранга
2) Биномиальное дерево ранга $k+1$ получается подвешиванием биномиального дерева ранга $k$ к корню другого биномиального дерева ранга $k$

Свойства биномимльногодерева (ранга $k$):
1) Имеет $2^k$ вершин
2) Имеет высоту $k$
3) На $i$-м уровне имеет $C_k^i$ вершин

==Опр.== **Биномиальная куча** - лес биномиальных деревьев попарно различных рангов, каждое из которых сохраняет [[Куча|свойство кучи]].

![[Pasted image 20250724203057.png]]

Свойства биномиальной кучи (размера $n$):
1) Состоит из $\log_2n$ биномиальных деревьев.
2) Ранг биномиального дерева соответствует его высоте, не считая корня. (Легко доказать индукцией по рангу)
3) Хранит указатель на корень того дерева, который содержит минимальный элемент.

### Операции

1) **Слияние деревьев** (за $O(\log n)$)
	Если деревья имеют одинаковый ранг, то дерево с большим корнем подвешиваем к корню дерева с меньшим корнем. Если в куче есть дерево с рангом таким же, что и полученное дерево, то применяем операцию слияния и к нему.

2) **Слияние куч** (за $O(\log n)$)
	Обновляем указатель на минимум. Для каждого дерева из меньшей кучи (перебираем по возрастанию ранга) сливаем его с деревом того же ранга второй кучи (если оно есть, иначе просто добавляем во вторую кучу). Такое слияние похоже на сложение чисел в двоичной СС, поэтому потребуется не более $\log n$ операций. ($n$ - суммарное количество элементов в обеих кучах)

3) **Получение минимума** (за $O(1)$)
	Выводим элемент под сохранённым указателем на минимум.

4) **Добавление элемента** (за $O(\log n)$)
	1) Создаём дерево из одной вершины - добавляемого элемента.
	2) Обновляем указатель на минимум.
	3) Если есть ещё одно дерево ранга 0, то сливаем их.

5) **Удаление минимума** (за $O(\log n)$)
	Заметим, что после удаления корня биномиального дерева, все полученные деревья тоже являются биномиальными, причём попарно различных рангов. То есть мы можем применить операцию слияния куч для детей узла с минимальным значением и всей остальной кучи без этого дерева. Проходом за $\log n$ обновляем указатель на минимум.

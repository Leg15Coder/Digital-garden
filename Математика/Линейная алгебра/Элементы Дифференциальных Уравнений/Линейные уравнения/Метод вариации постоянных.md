==Опр.== **Метод вариации постоянных (МВП)** - метод нахождения частного решения ДУ, зная общее решение соответствующего ОДУ, путём замены констант общего решения на вспомогательные функции.

## МВП для [[Линейные уравнения|ЛДУ]]

Пусть $\{y_k\}_{k=1}^n$ - ФСР соответствующего к данному ЛДУ ОЛДУ. Ищем частное решение в виде:
$$y(x) = \sum_{k=1}^n c_k(x) y_k(x)$$

### Теорема (Система Лагранжа)

Если дифференцируемые функции $c_k(x)$ удовлетворяют системе:
$$\begin{cases} 
\sum c'_k y_k = 0 \\
\sum c'_k y'_k = 0 \\
\dots \\
\sum c'_k y_k^{(n-2)} = 0 \\
\sum c'_k y_k^{(n-1)} = \frac{F(x)}{a_0} 
\end{cases}$$
то функция $y(x)$ является решением неоднородного уравнения.

#### Доказательство

1. Вычислим, используя общее решение ОЛДУ: $y'(x) = \sum c'_k y_k + \sum c_k y'_k =$ \[из 1-го уравнения системы\] $= \sum c_k y'_k$.
2. По индукции для $\forall$ $l < n$ получаем $y^{(l)}(x) =$ $(y^{(l-1)})'(x) =$ $\sum c'_k y^{(l-1)}_k + \sum c_k y^{(l)}_k$ $= \sum c_k y_k^{(l)}$ благодаря уравнениям системы.
3. Для $n$-й производной: $y^{(n)}(x) = \sum c'_k y_k^{(n-1)} + \sum c_k y_k^{(n)}$.
4. Подставим найденные производные в исходное уравнение:   $a_0 (\sum\limits_{k} c'_k y_k^{(n-1)} + \sum\limits_{k} c_k y_k^{(n)}) + \sum\limits_{j=1}^n a_j (\sum\limits_{k} c_k y_k^{(n-j)})$ $= F(x)$.
5. Перегруппируем: $a_0 \sum\limits_{k} c'_k y_k^{(n-1)} + \sum\limits_{k} c_k (\sum\limits_{j=0}^n a_j y_k^{(n-j)})$ $= F(x)$.
6. Вторая сумма равна 0, так как $y_k$ - решения ОЛДУ, а $a_j = const$. Остается $a_0 \cdot \frac{F(x)}{a_0} = F(x)$, что является тождеством.

## МВП для СЛДУ

Пусть $\Phi(t)$ - ФМР однородной системы. Ищем решение СЛУ в виде:
$$x(t) = \Phi(t)c(t)$$
### Общее решение НСЛДУ:
$$x(t) = \Phi(t)c_0 + \Phi(t) \int_{t_0}^t \Phi^{-1}(s)b(s) ds, \quad c_0 \in \mathbb{R}^n$$
#### Доказательство
1. Дифференцируем общее решение ОСЛУ: $\dot{x} = \dot{\Phi}c + \Phi\dot{c}$.
2. Подставляем в СЛУ: $\dot{\Phi}c + \Phi\dot{c} = A\Phi c + b(t)$.
3. Так как $\dot{\Phi} = A\Phi$, получаем: $A\Phi c + \Phi\dot{c} = A\Phi c + b(t) \implies \Phi\dot{c} = b(t)$.
4. Поскольку $\Phi(t)$ невырождена: $\dot{c}(t) = \Phi^{-1}(t)b(t)$.
5. Интегрируем: $c(t) = c_0 + \int_{t_0}^t \Phi^{-1}(s)b(s) ds$.

## Замечание

- При доказательстве МВП нигде не использовалось, что $A$ - матрица или матричная функция, поэтому МВП работает как для случая постоянных коэффициентов, так и для случая переменных коэффициентов

---

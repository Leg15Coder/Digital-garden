Пусть $k_1$ - положительно определённая КФ с матрицей $B_1$ и соответствующей БФ $b_1$, а $k_2$ - произвольная КФ с матрицей $B_2$ и соответствующей БФ $b_2$.
В алгоритме будем пользоваться [[Квадратичная форма в евклидовом пространстве|свойствами КФ в евклидовом пространстве]] для нахождения базиса, в котором КФ-мы будут иметь искомый диагональный вид.

# Прямое построение (1 способ)

1) Приводим к каноническому виду $k_1$ с помощью [[Канонический вид КФ#Метод Лагранжа|алгоритма Лагранжа]]. Мы получили ОНБ в евклидовом пространстве со скалярным произведением $b_1$.
2) Находим собственные вектора $B_2$ в построенном ОНБ.
3) Используем [[Алгоритм ортогонализации Грама-Шмидта|алгоритм ортогонализации Грама-Шмидта]] со стандартным скалярным произведением (не $b_1$, и не $b_2$, а исходное в евклидовом пространстве) для построения ОНБ из базиса собственных векторов матрицы $B_2$
4) Полученный базис и есть искомый.

# Матричное построение (2 способ)

1) Решаем уравнение $det(B_1^{-1}B_2 - \lambda E) = det(B_1^{-1}B_2 - \lambda B_1^{-1}B_1) = det(B_1^{-1}) \cdot det(B_2 - \lambda B_1) = 0$ $\Leftrightarrow$ $det(B_2 - \lambda B_1) = 0$ - обобщённое характеристическое уравнение. Таким образом мы находим СЗ и СВ преобразования, присоединённого к $k_2$ относительно $b_1$ как скалярного произведения
2) Решаем СЛУ $(H - \lambda F)x = 0$ для всех СЗ.
3) Нормируем СВ используя $b_1$ как скалярное произведение в [[Алгоритм ортогонализации Грама-Шмидта|алгоритме Грама-Шмидта]].
4) Полученный базис и есть искомый. 

==Опр.== $BPP$ *(Bounded-error Probabilistic Polynomial)* - класс языков *(обозначим язык $A$)*, для которых $\exists$ [[Вероятностная машина Тьюринга (ВМТ)|ПВМТ]] $V$, т.ч.$$\begin{cases} x \in A & \Longrightarrow & P(V(x) = 1) \geq \frac{2}{3}\\ x \not\in A & \Longrightarrow & P(V(x) = 1) \leq \frac{1}{3} \end{cases}$$

Пусть $\alpha, \beta : \mathbb{N}_0 \to [0; 1]$, тогда
==Опр.== $BPP_{\alpha, \beta}$ - класс языков *(обозначим язык $A$)*, для которых $\exists$ [[Вероятностная машина Тьюринга (ВМТ)|ПВМТ]] $V$, т.ч.$$\begin{cases} x \in A & \Longrightarrow & P(V(x) = 1) \geq \beta(|x|)\\ x \not\in A & \Longrightarrow & P(V(x) = 1) \leq \alpha(|x|) \end{cases}$$

==Опр.== $BPP^p$ - класс $BPP$, но в отличие от классического $BPP$ значение бита выбирается в схеме Бернулли не с параметром $\frac{1}{2}$, а с параметром $p$

## Свойства вложенности вероятностных классов

## [[Амплификация]] $BPP$ и его разновидностей
### Амплификация $BPP$ с константой
- $\forall a \in (0; \frac{1}{2})\ \forall b \in (\frac{1}{2}; 1)$ класс языков $BPP_{a, b}$, для которых $\exists$ ПВМТ $V$, т.ч.$$\begin{cases} x \in A & \Longrightarrow & P(V(x) = 1) \geq b\\ x \not\in A & \Longrightarrow & P(V(x) = 1) \leq a \end{cases}$$ равен $BPP$, то есть $BPP = BPP_{a, b}$

#### Доказательство

Пусть для простоты $a = p$, $b = 1 - p$ (в общем случае доказывается аналогично, но чуть более громоздко).
Амплифицируем $V$ $n$ запусками.
По формуле бинома ньютона: $(p + (1-p))^n =$ $\sum\limits_{k = 0}^n C_n^k p^k (1-p)^{n-k} =$ $\sum\limits_{k=0}^{\lfloor \frac{n-1}{2} \rfloor} C_n^k p^k (1-p)^{n-k} + \sum\limits_{k=\lfloor \frac{n}{2} \rfloor}^n C_n^k p^k (1-p)^{n-k}$. Обозначим первую сумму $Z$, а вторую - $X$. $Z$ описывает те случаи, когда $V$ при многократном запуске ошиблась с ответом $< \frac{n}{2}$ раз, то есть в итоге дала верный ответ. В $X$ же количество ошибок превысило количество верных ответов, поэтому и итоговый ответ ошибочный. Нужно уменьшить вероятность $X$. Построим оценку:

$X = \sum\limits_{k=\lfloor \frac{n}{2} \rfloor}^n C_n^k p^k (1-p)^{n-k}$ $\leq \sum\limits_{k=0}^{\frac{n}{2}} C_n^{k + \frac{n}{2}} p^{k + \frac{n}{2}} (1-p)^{\frac{n}{2}-k} =$ $(p(1-p))^{\frac{n}{2}}\sum\limits_{k=0}^{\frac{n}{2}} C_n^{\frac{n}{2}+k} p^k (1-p)^{-k}$ $\leq (2 \sqrt{p(1-p)})^n <$ \[т.к. при $p \neq 1 - p$ среднее геометрическое меньше среднего арифметического\] $< (2\frac{p + (1 - p)}{2})^n$ $= 1$

Теперь сделаем $n$ функцией от длины входа: $n(x) = |x|^m$, заметим, что $\lim\limits_{m \to \infty}(2 \sqrt{p(1-p)})^{n(x)} = 0$ $\Rightarrow$ $\forall p \in (0; \frac{1}{2})\ \exists m_0 \in \mathbb{N}\ :\ (2 \sqrt{p(1-p)})^{|x|^{m_0}} < p$. То есть мы можем уменьшить вероятность ошибки до любого сколь угодно малого значения, выполнив $O(poly(|x|))$ запусков ПВМТ, то есть сохраняя общую полиномиальность алгоритма, то есть не меняя класс.

## $BPP$ vs $BPP^p$
### Теорема о вложенности
$$\forall p \in (0;1)\ :\ BPP \subseteq BPP^p$$

### Теорема о совпадении
1) $BPP = BPP^p$, если $i$-й знак числа $p \in (0; 1)$ в его двоичной записи можно получить вероятностным алгоритмом за полиномиальное от $i$ время.
2) $\exists p \in (0; 1)\ :\ BPP \subsetneq BPP^p$

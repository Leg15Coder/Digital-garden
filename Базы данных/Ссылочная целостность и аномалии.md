
==Опр.== **Ссылочная целостность** – необходимое качество [[Реляционная модель данных|реляционной]] БД, заключающееся в отсутствии в любом её отношении [[Ключи в отношениях#^517c1b|внешних ключей]], ссылающихся на несуществующие кортежи.

#### [[Виды операторов в SQL|Операторы]] поддержания ссылочной целостности

| Действие          | Описание                                                                                       | Когда использовать                                                                     | Пример использования                                                      |
| ----------------- | ---------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- |
| **`CASCADE`**     | При удалении/изменении родительской записи, дочерние записи автоматически удаляются/изменяются | Когда дочерние записи не имеют смысла без родительской (например, комментарии к посту) | `FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE`            |
| **`RESTRICT`**    | Запрещает удаление/изменение родительской записи, если существуют зависимые записи             | Когда нужно явно предотвратить потерю связанных данных                                 | `FOREIGN KEY (dept_id) REFERENCES departments(id) ON DELETE RESTRICT`     |
| **`NO ACTION`**   | Аналогично RESTRICT, но проверка выполняется в конце транзакции                                | Когда нужно временно нарушить целостность в рамках транзакции                          | `FOREIGN KEY (order_id) REFERENCES orders(id) ON UPDATE NO ACTION`        |
| **`SET NULL`**    | При удалении родительской записи, внешний ключ устанавливается в NULL                          | Когда связь опциональна, и потеря родителя допустима (например, менеджер товара)       | `FOREIGN KEY (manager_id) REFERENCES employees(id) ON DELETE SET NULL`    |
| **`SET DEFAULT`** | Аналогично SET NULL, но устанавливается значение по умолчанию                                  | Когда есть осмысленное значение по умолчанию для зависимых записей                     | `FOREIGN KEY (status_id) REFERENCES statuses(id) ON DELETE SET DEFAULT 1` |

#### Аномалии

==Опр.== **Аномалия** – ситуация в БД, которая приводит к противоречию в данных или их связях, либо же усложняет обработку данных.

Возможные аномалии:
- Дублирование данных
- Потеря данных
- Неконсистентность данных 
- Неизвестность внешних ключей (аномалия добавления)
- и др.

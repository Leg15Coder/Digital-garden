
==Опр.== **Агрегирующая функция** - функция, которая выполняет действия над набором данных и возвращает одно результирующее значение

##### Агрегирующие функции в [[SQL]]

| Функция                        | Описание                                                                   | Пример                                                |
| ------------------------------ | -------------------------------------------------------------------------- | ----------------------------------------------------- |
| `count(val)`                   | Подсчёт количества строк                                                   | `SELECT count(DISTINCT department_id) FROM employees` |
| `sum(val)`                     | Суммирование значений **числового** столбца                                | `SELECT sum(salary) FROM employees`                   |
| `avg(val)`                     | Среднее значение **числового** столбца                                     | `SELECT avg(salary) FROM employees`                   |
| `min(val)`                     | Минимальное значение                                                       | `SELECT min(hire_date) FROM employees`                |
| `max(val)`                     | Максимальное значение                                                      | `SELECT max(hire_date) FROM employees`                |
| `string_agg(value, separator)` | Соединяет значения **текстового** столбца через<br>разделитель `separator` | `SELECT string_agg(name, ' ') FROM employees`         |
| `coalesce(*args)`              | Возвращает первое непустое значение                                        | `SELECT coalesce(*) FROM (NULL, 1, 'hi', NULL, 0)`    |

***Агрегирующие функции игнорируют `NULL`-значения***

Пример подсчёта агрегирующих функций в тернарном массиве (массиве с `NULL`):

`value = (1, NULL, 3, 25, NULL, 0)`

| Функция               | Результат | Объяснение                                           |
| --------------------- | --------- | ---------------------------------------------------- |
| **`sum(value)`**      | 29        | Сумма всех не-NULL значений: `1 + 3 + 25 + 0 = 29`   |
| **`min(value)`**      | 0         | Наименьшее значение среди: `1, 3, 25, 0`             |
| **`max(value)`**      | 25        | Наибольшее значение среди: `1, 3, 25, 0`             |
| **`avg(value)`**      | 7.25      | Среднее значение: `(1 + 3 + 25 + 0) / 4 = 7.25`      |
| **`count(value)`**    | 4         | Количество не-NULL значений: `1, 3, 25, 0` (всего 4) |
| **`coalesce(value)`** | 1         | 1 - первое непустое значение                         |
